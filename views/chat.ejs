<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Let's have some conversation...</title>
</head>
<body>
    <h1>If one of you stops talking, the conversation will end "magically".</h1>
    <div id="joined"></div>
    <div id="messages">
        <input id="message" type="text" name="message" placeholder="Start chatting here...">
        <br />
        <button onClick="sendMessage()">Send</button>
    </div>
</body>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io("http://localhost:5000")

    socket.on("join", username => {
        const element = document.createElement("h5");
        element.innerText = `${username} has joined.`;
        document.querySelector("#joined").appendChild(element);
    });

    socket.on("message", ({ message, from }) => {
      const element = document.createElement("h5");
      element.innerText = `${from} said: ${message}`;
      document.querySelector("#messages").appendChild(element);
    });

    function sendMessage() {
      const message = document.querySelector("#message").value;
      if (message.length > 0) {
        socket.emit("message", { message, from: "<%= username %>" });
      }
    }
</script>
</html>
